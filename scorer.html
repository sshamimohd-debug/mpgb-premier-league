<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Scorer â€¢ MPGB Premier League</title>
  <meta name="theme-color" content="#0b1220" />
  <link rel="icon" href="icons/icon-192.png" />
  <link rel="apple-touch-icon" href="icons/icon-192.png" />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header class="topbar">
    <div class="brand">
      <div class="bt1">MPGB Premier League 2025-26</div>
      <div class="bt2">Scorer Console</div>
    </div>
    <div class="top-actions">
      <a class="btn ghost" id="backLive" href="#">Live</a>
      <a class="btn ghost" href="matches.html">Matches</a>
    </div>
  </header>

  <main class="container has-fixed-keypad">
    <div id="sticky" class="sticky-scorebar card"></div>

    <!-- PRE-MATCH / ADMIN SETUP -->
    <div class="card">
      <div class="row between">
        <div class="h2">Match Setup</div>
        <div class="row gap">
          <button class="btn ghost" id="btnLock">Lock</button>
          <button class="btn ghost" id="btnResetInnings">Reset Innings</button>
        </div>
      </div>

      <div class="grid2">
        <label class="field">
          <span class="muted">Toss Winner</span>
          <select id="tossWinnerSel"></select>
        </label>
        <label class="field">
          <span class="muted">Decision</span>
          <select id="tossDecisionSel">
            <option value="">Select</option>
            <option value="BAT">Bat</option>
            <option value="BOWL">Bowl</option>
          </select>
        </label>

        <div class="row gap">
          <button class="btn" id="btnSaveToss">Save Toss</button>
          <button class="btn ghost" id="btnStartInnings1">Start Innings 1</button>
          <button class="btn ghost" id="btnEndInnings">End Innings</button>
          <button class="btn danger" id="btnFinish">Finalize Result</button>
        </div>
      </div>

      <details style="margin-top:10px">
        <summary class="muted">Squad 15 & Playing XI (demo names now)</summary>
        <div class="grid2" style="margin-top:10px">
          <div>
            <div class="h3" id="xiTitleA">Team A</div>
            <div class="muted tiny">Select exactly 11</div>
            <div id="xiA" class="xiBox"></div>
          </div>
          <div>
            <div class="h3" id="xiTitleB">Team B</div>
            <div class="muted tiny">Select exactly 11</div>
            <div id="xiB" class="xiBox"></div>
          </div>
        </div>
        <div class="row gap" style="margin-top:10px">
          <button class="btn" id="btnSaveXI">Save Playing XI</button>
        </div>
      </details>

      <div id="scMsg" class="muted" style="margin-top:10px"></div>
    </div>

    <!-- ON-FIELD SELECTION -->
    <div class="card">
      <div class="row between">
        <div class="h2">On-field Players</div>
        <div class="muted tiny">Bowler max 2 overs (T10)</div>
      </div>

      <div class="grid2">
        <label class="field">
          <span class="muted">Striker</span>
          <select id="strikerSel"></select>
        </label>
        <label class="field">
          <span class="muted">Non-striker</span>
          <select id="nonSel"></select>
        </label>
        <label class="field">
          <span class="muted">Bowler</span>
          <select id="bowlerSel"></select>
        </label>
        <div class="row gap">
          <button class="btn" id="btnSetPlayers">Set</button>
          <button class="btn ghost" id="btnSwap">Swap Strike</button>
        </div>
      </div>
    </div>

    <!-- RECENT -->
    <div class="card">
      <div class="h2">Recent</div>
      <div id="comm" class="comm"></div>
    </div>

    <div id="fbBanner" class="banner warn" style="display:none"></div>

    <!-- KEYPAD -->
    <div class="scoring-keypad">
      <div class="keygrid">
        <button class="k" data-run="0">0</button>
        <button class="k" data-run="1">1</button>
        <button class="k" data-run="2">2</button>
        <button class="k" data-run="3">3</button>
        <button class="k" data-run="4">4</button>
        <button class="k" data-run="6">6</button>
      </div>

      <div class="keygrid">
        <button class="k ghost" data-extra="WD">WD</button>
        <button class="k ghost" data-extra="NB">NB</button>
        <button class="k ghost" data-extra="BYE">Bye</button>
        <button class="k ghost" data-extra="LB">LB</button>
        <button class="k danger" id="btnWicket">Wicket</button>
        <button class="k ghost" id="btnUndo">Undo</button>
      </div>

      <div class="muted tiny" style="margin-top:6px">Tip: Set Playing XI once, then select on-field players from dropdowns.</div>
    </div>
  </main>

  <!-- Wicket modal -->
  <div class="modal" id="wktModal">
    <div class="modal-card">
      <div class="h2">Wicket Details</div>

      <label class="field" style="margin-top:10px">
        <span class="muted">Kind</span>
        <select id="wktKind">
          <option value="Bowled">Bowled</option>
          <option value="Caught">Caught</option>
          <option value="LBW">LBW</option>
          <option value="Run out">Run out</option>
          <option value="Stumped">Stumped</option>
          <option value="Hit wicket">Hit wicket</option>
          <option value="Retired out">Retired out</option>
        </select>
      </label>

      <label class="field">
        <span class="muted">Batter out</span>
        <select id="wktBatter"></select>
      </label>

      <label class="field">
        <span class="muted">Fielder (optional)</span>
        <input id="wktFielder" placeholder="Fielder name"/>
      </label>

      <label class="field">
        <span class="muted">Runs on this ball (0-6)</span>
        <input id="wktRuns" inputmode="numeric" placeholder="0"/>
      </label>

      <div class="row gap" style="margin-top:10px">
        <button class="btn danger" id="wktOk">Save Wicket</button>
        <button class="btn ghost" id="wktCancel">Cancel</button>
      </div>
      <div class="muted tiny" style="margin-top:8px">Note: Run-out/Retired-out doesn't credit bowler wicket.</div>
    </div>
  </div>

  <!-- Result modal -->
  <div class="modal" id="resModal">
    <div class="modal-card">
      <div class="h2">Finalize Result</div>

      <label class="field" style="margin-top:10px">
        <span class="muted">Winner</span>
        <select id="resWinner"></select>
      </label>

      <label class="field">
        <span class="muted">Method</span>
        <select id="resMethod">
          <option value="Runs">Won by runs</option>
          <option value="Wickets">Won by wickets</option>
          <option value="NR">No result</option>
          <option value="Tie">Tie</option>
          <option value="Super Over">Super Over</option>
        </select>
      </label>

      <label class="field">
        <span class="muted">Margin (e.g., 12 runs / 3 wickets)</span>
        <input id="resMargin" placeholder=""/>
      </label>

      <label class="field">
        <span class="muted">Man of the Match (optional)</span>
        <input id="resMOM" placeholder=""/>
      </label>

      <label class="field">
        <span class="muted">Note (optional)</span>
        <input id="resNote" placeholder=""/>
      </label>

      <div class="row gap" style="margin-top:10px">
        <button class="btn primary" id="resOk">Save Result</button>
        <button class="btn ghost" id="resCancel">Cancel</button>
      </div>
    </div>
  </div>

  <!-- PIN modal -->
  <div class="modal" id="pinModal">
    <div class="modal-card">
      <div class="h2">Enter Scorer PIN</div>
      <div class="muted">PIN is required to start scoring for this match.</div>
      <input id="pinInput" type="password" inputmode="numeric" placeholder="PIN" style="margin-top:10px" />
      <div class="row gap" style="margin-top:10px">
        <button class="btn primary" id="pinOk">Unlock</button>
        <a class="btn ghost" id="pinCancel" href="#">Cancel</a>
      </div>
      <div id="pinMsg" class="muted" style="margin-top:8px"></div>
    </div>
  </div>

  <!-- Firebase SDKs (compat) -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

  <script src="firebase.js"></script>
  <script src="data.js"></script>
  <script src="scoring_engine.js"></script>
  <script src="realtime.js"></script>
  <script src="scorer_page.js"></script>
</body>
</html>
